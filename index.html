<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurador Pro Cafe Racer</title>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
    
    <style>
        :root {
            --accent: #ff4444; 
            --bg: #0a0a0a;
            --panel-bg: #ffffff;
            --border: rgba(0, 122, 255, 0.08);
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: white;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Pantalla de inicio */
        #landing {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), url('BMW-K100-Cafe-Racer-1.jpg'); 
            background-size: cover; background-position: center;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 100; transition: transform 0.6s cubic-bezier(0.85, 0, 0.15, 1);
        }

        .btn-configurar {
            padding: 15px 40px; background: var(--accent); color: white;
            border: none; border-radius: 50px; cursor: pointer;
            font-weight: bold; text-transform: uppercase; margin-top: 20px;
        }

        .hidden { transform: translateY(-100%); }

        /* Visor 3D */
        model-viewer {
            flex: 1; height: 100%;
            background: radial-gradient(#ffffff, #ccc8c8);
        }

        /* Sidebar con Scroll Mejorado */
        .sidebar {
            width: 320px;
            background: var(--panel-bg);
            border-left: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            z-index: 10;
        }

        .sidebar-header {
            padding: 20px 25px;
            border-bottom: 1px solid var(--border);
            background: #F5F5F5;
        }

        .scroll-container {
            flex: 1;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--accent) #F5F5F5;
        }

        h2 { font-size: 1rem; text-transform: uppercase; letter-spacing: 2px; margin: 0; color: var(--accent); }

        /* Estilos Acordeón */
        .accordion {
            background-color: transparent;
            color: #1129c2;
            cursor: pointer;
            padding: 18px 25px;
            width: 100%;
            border: none;
            border-bottom: 1px solid var(--border);
            text-align: left;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
            transition: 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .accordion:hover { background-color: #1129c2; color: white; }
        
        .accordion:after {
            content: '\002B';
            color: var(--accent);
            font-size: 1.1rem;
            transition: 0.3s;
        }

        .active { background-color: #1a1a1a; color: white; border-bottom: 1px solid var(--accent); }
        .active:after { content: "\2212"; transform: rotate(180deg); }

        .panel {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
            background-color: #0d0d0d;
        }

        .panel-content { padding: 20px 25px; }

        /* Grid de Colores */
        label { display: block; font-size: 0.65rem; color: #666; text-transform: uppercase; margin-bottom: 10px; font-weight: bold; }
        .color-grid {
            display: flex;       /* Alinea los círculos en fila */
            gap: 10px;          /* Espacio entre círculos */
            padding: 10px 0;
        }
        .color-dot {
            width: 30px;         /* Ajusta el tamaño a tu gusto */
            height: 30px;        /* Debe ser igual al ancho */
            border-radius: 50%;  /* Esto es lo que hace que sea un círculo */
            cursor: pointer;
            display: inline-block;
            margin: 5px;
            border: 2px solid transparent; 
            transition: transform 0.2s; /* Un toque extra para que se sienta fluido */
        }

        /* Opcional: un efecto cuando pasas el ratón por encima */
        .color-dot:hover {
            transform: scale(1.1);
            border-color: #3498db;
        }

        .btn-finish {
            flex: 1; background: #222; color: white; border: 1px solid #333;
            padding: 8px; cursor: pointer; font-size: 9px; text-transform: uppercase;
        }
        .btn-finish:hover { background: var(--accent); border-color: white; }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--accent); }
    </style>
</head>
<body>

    <section id="landing">
        <h1>CAFE RACER LAB</h1>
        <button class="btn-configurar" onclick="startApp()">Personalizar BMW K100</button>
    </section>

    <model-viewer id="moto-3d" src="BMWK100.glb" camera-controls auto-rotate shadow-intensity="1.5" exposure="1.1" camera-orbit="45deg 75deg 105%"></model-viewer>

    <div class="sidebar">
        <div class="sidebar-header">
            <h2>Configurador</h2>
        </div>

        <div class="scroll-container">
            <button class="accordion">Carrocería</button>
            <div class="panel">
                <div class="panel-content">
                    <label>Depósito</label>
                    <div class="color-grid">
                        <div class="color-dot" style="background:#d32f2f" onclick="changeColor('Tanque', '#d32f2f')"></div>
                        <div class="color-dot" style="background:#111" onclick="changeColor('Tanque', '#111')"></div>
                        <div class="color-dot" style="background:#bdc3c7" onclick="changeColor('Tanque', '#bdc3c7')"></div>
                        <div class="color-dot" style="background:#1976d2" onclick="changeColor('Tanque', '#1976d2')"></div>
                    </div>
                    <label>Guardabarros</label>
                    <div class="color-grid">
                        <div class="color-dot" style="background:#d32f2f" onclick="changeColor('Guardabarros', '#d32f2f')"></div>
                        <div class="color-dot" style="background:#111" onclick="changeColor('Guardabarros', '#111')"></div>
                    </div>
                </div>
            </div>

            <button class="accordion">Mecánica & Chasis</button>
            <div class="panel">
                <div class="panel-content">
                    <label>Chasis</label>
                    <div class="color-grid">
                        <div class="color-dot" style="background:#111" onclick="changeColor('Chasis', '#111')"></div>
                        <div class="color-dot" style="background:#bdc3c7" onclick="changeColor('Chasis', '#bdc3c7')"></div>
                    </div>
                    <label>Motor</label>
                    <div class="color-grid">
                        <div class="color-dot" style="background:#111" onclick="changeColor('Motor', '#111')"></div>
                        <div class="color-dot" style="background:#bdc3c7" onclick="changeColor('Motor', '#bdc3c7')"></div>
                    </div>
                </div>
            </div>

            <button class="accordion">Iluminación</button>
            <div class="panel">
                <div class="panel-content">
                    <label>Carcasa de Faro</label>
                    <div class="color-grid">
                        <div class="color-dot" style="background:#111" onclick="changeColor('Luz', '#111')"></div>
                        <div class="color-dot" style="background:#bdc3c7" onclick="changeColor('Luz', '#bdc3c7')"></div>
                    </div>
                </div>
            </div>

            <button class="accordion">Tren Delantero</button>
            <div class="panel">
                <div class="panel-content">
                    <label>Horquillas</label>
                    <div class="color-grid">
                        <div class="color-dot" style="background:#bdc3c7" onclick="changeColor('Horquillas', '#bdc3c7')"></div>
                        <div class="color-dot" style="background:#d4af37" onclick="changeColor('Horquillas', '#d4af37')"></div>
                        <div class="color-dot" style="background:#111" onclick="changeColor('Horquillas', '#111')"></div>
                    </div>
                </div>
            </div>

            <button class="accordion">Suspensión Trasera</button>
            <div class="panel">
                <div class="panel-content">
                    <label>Muelle</label>
                    <div class="color-grid">
                        <div class="color-dot" style="background:#ff0000" onclick="changeColor('Muelle', '#ff0000')"></div>
                        <div class="color-dot" style="background:#f1c40f" onclick="changeColor('Muelle', '#f1c40f')"></div>
                    </div>
                </div>
            </div>

            <button class="accordion">Llantas</button>
            <div class="panel">
                <div class="panel-content">
                    <label>Color</label>
                    <div class="color-grid">
                        <div class="color-dot" style="background:#000" onclick="changeColor('Llantas', '#000')"></div>
                        <div class="color-dot" style="background:#bdc3c7" onclick="changeColor('Llantas', '#bdc3c7')"></div>
                    </div>
                    <label>Acabado</label>
                    <div style="display:flex; gap:10px;">
                        <button class="btn-finish" onclick="setRoughness('Llantas', 0.05)">Cromo</button>
                        <button class="btn-finish" onclick="setRoughness('Llantas', 0.9)">Mate</button>
                    </div>
                </div>
            </div>
            
            <button class="accordion">Instrumentación</button>
            <div class="panel">
                <div class="panel-content">
                    <label>Tipo de Tacómetro</label>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <button class="btn-finish" id="btn-analog" onclick="toggleTacometro('analogico')">Analógico Retro</button>
                        <button class="btn-finish" id="btn-digital" onclick="toggleTacometro('digital')">Digital Moderno</button>
                    </div>
                    <p style="font-size: 0.6rem; color: #555; margin-top: 10px; text-transform: uppercase;">
                        * Cambia el estilo del panel de instrumentos
                    </p>
                </div>
            </div>
        </div>
    </div>

<script>
    const modelViewer = document.querySelector('#moto-3d');

    function startApp() {
        document.getElementById('landing').classList.add('hidden');
    }

    // LÓGICA DE ACORDEÓN EXCLUSIVO (Solo uno abierto a la vez)
    const acc = document.getElementsByClassName("accordion");
    
    for (let i = 0; i < acc.length; i++) {
        acc[i].addEventListener("click", function() {
            const panel = this.nextElementSibling;
            const isActive = this.classList.contains("active");

            // 1. Cerramos todos los paneles abiertos
            for (let j = 0; j < acc.length; j++) {
                acc[j].classList.remove("active");
                acc[j].nextElementSibling.style.maxHeight = null;
            }

            // 2. Si el que clickamos no estaba activo, lo abrimos
            if (!isActive) {
                this.classList.add("active");
                panel.style.maxHeight = panel.scrollHeight + "px";
            }
        });
    }

    function changeColor(pieza, color) {
        const material = modelViewer.model.materials.find(m => m.name === pieza);
        if (material) material.pbrMetallicRoughness.setBaseColorFactor(color);
    }

    function setRoughness(pieza, valor) {
        const material = modelViewer.model.materials.find(m => m.name === pieza);
        if (material) material.pbrMetallicRoughness.setRoughnessFactor(valor);
    }

   // Variable para rastrear el estado
let tacometroActual = 'analogico';

// Ejecutar configuración inicial cuando el modelo cargue
modelViewer.addEventListener('load', () => {
    console.log("Modelo cargado, configurando tacómetros...");
    // Forzamos el estado inicial
    toggleTacometro('analogico');
});

function toggleTacometro(tipo) {
    const materiales = modelViewer.model.materials;
    
    materiales.forEach(mat => {
        // Buscamos los materiales específicos
        if (mat.name === "Tacometro_Analogico" || mat.name === "Tacometro_Digital") {
            
            if (tipo === 'analogico') {
                if (mat.name === "Tacometro_Analogico") {
                    mat.setAlphaMode("OPAQUE");
                    mat.pbrMetallicRoughness.setBaseColorFactor([1, 1, 1, 1]);
                } else {
                    // Ocultamos el digital
                    mat.setAlphaMode("BLEND");
                    mat.pbrMetallicRoughness.setBaseColorFactor([1, 1, 1, 0]);
                }
            } else {
                if (mat.name === "Tacometro_Digital") {
                    mat.setAlphaMode("OPAQUE");
                    mat.pbrMetallicRoughness.setBaseColorFactor([1, 1, 1, 1]);
                } else {
                    // Ocultamos el analógico
                    mat.setAlphaMode("BLEND");
                    mat.pbrMetallicRoughness.setBaseColorFactor([1, 1, 1, 0]);
                }
            }
        }
    });

    // Feedback visual en los botones (opcional)
    document.getElementById('btn-analog').style.borderColor = (tipo === 'analogico') ? 'var(--accent)' : '#333';
    document.getElementById('btn-digital').style.borderColor = (tipo === 'digital') ? 'var(--accent)' : '#333';
}
</script>
</body>
</html>










